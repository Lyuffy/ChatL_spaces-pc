<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <title>ChatL</title>
  <style>
    body {
      margin: 0;
      padding: 0;
      font-family: sans-serif;
      color: #00ffff;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      height: 100vh;
      overflow: hidden;
      position: relative;
    }

    #bg-page {
      position: fixed;
      top: 0;
      left: 0;
      width: 100vw;
      height: 100vh;
      object-fit: cover;
      z-index: -2;
      pointer-events: none;
    }

    #chat-icon {
      background-color: #1a1f2e;
      color: #00ffff;
      border: 2px solid #7f00ff;
      padding: 10px 20px;
      border-radius: 8px;
      cursor: pointer;
      margin-bottom: 20px;
      z-index: 1;
    }

    #chat-box {
      display: flex;
      flex-direction: column;
      width: 80vw;
      max-width: 600px;
      height: 70vh;
      border: 2px solid #7f00ff;
      padding: 20px;
      box-sizing: border-box;
      position: relative;
      overflow: hidden;
      z-index: 1;
      opacity: 0;
      transform: scale(0.95);
      transition: opacity 0.3s ease, transform 0.3s ease;
      pointer-events: none;
    }

    #chat-box.active {
      opacity: 1;
      transform: scale(1);
      pointer-events: auto;
    }

    #bg-chat {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
      z-index: -1;
      pointer-events: none;
    }

    #profile-area {
      display: flex;
      align-items: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    #profile-pic {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      object-fit: cover;
      border: 2px solid #7f00ff;
    }

    #username-input {
      flex: 1;
      padding: 10px;
      background: rgba(0,0,0,0.6);
      color: #00ffff;
      border: 1px solid #7f00ff;
      box-sizing: border-box;
    }

    #upload-btn {
      cursor: pointer;
    }

    #upload-btn img {
      width: 32px;
      height: 32px;
      border-radius: 6px;
      border: 1px solid #7f00ff;
    }

    input[type="file"] {
      display: none;
    }

    #messages {
      flex: 1;
      overflow-y: auto;
      margin-bottom: 10px;
      background: rgba(0,0,0,0.4);
      padding: 10px;
      border: 1px solid #7f00ff;
      color: #00ffff;
    }

    .message {
      display: flex;
      align-items: center;
      gap: 10px;
      margin: 8px 0;
      padding: 10px 14px;
      max-width: 80%;
      background: linear-gradient(135deg, rgba(0,255,255,0.2), rgba(127,0,255,0.2));
      border: 1px solid #7f00ff;
      border-radius: 12px 12px 12px 0;
      box-shadow: 0 2px 6px rgba(0,0,0,0.3);
      font-size: 14px;
      animation: fadeInUp 0.3s ease;
      backdrop-filter: blur(2px);
    }

    .typing-indicator {
      font-style: italic;
      opacity: 0.7;
      margin: 4px 0;
    }

    @media screen and (max-width: 600px) {
  #chat-box {
    width: 95vw;
    height: 80vh;
    padding: 12px;
  }

  #profile-area {
    flex-direction: column;
    align-items: flex-start;
    gap: 6px;
  }

  #username-input {
    width: 100%;
  }

  #upload-btn img {
    width: 28px;
    height: 28px;
  }

  .message {
    font-size: 13px;
    padding: 8px 10px;
    max-width: 100%;
  }

  #input-area {
    flex-direction: column;
    gap: 6px;
  }

  #message-input, #send-btn {
    width: 100%;
  }

  #chat-icon {
    font-size: 14px;
    padding: 8px 16px;
  }
}

    @keyframes fadeInUp {
      from {
        opacity: 0;
        transform: translateY(10px);
      }
      to {
        opacity: 1;
        transform: translateY(0);
      }
    }

    #input-area {
      display: flex;
      gap: 10px;
    }

    input[type="text"], button {
      background: rgba(0,0,0,0.6);
      color: #00ffff;
      border: 1px solid #7f00ff;
      padding: 10px;
    }

    #message-input {
      flex: 1;
    }

    #send-btn {
      cursor: pointer;
    }
  </style>
</head>
<body>

<img id="bg-page" src="Background/pom-2pc.jpeg" alt="Background Halaman">

<div id="chat-icon">ðŸ’¬ CHAT</div>

<div id="chat-box">
  <img id="bg-chat" src="Background/bg-chat.jpg" alt="Background Chat Box">

  <div id="profile-area">
    <img id="profile-pic" src="profile/default.png" alt="Profil">
    <input type="text" id="username-input" placeholder="Masukkan username">
    <label id="upload-btn" for="upload-input">
      <img src="Background/photo_profil.jpg" alt="Upload Icon">
    </label>
    <input type="file" id="upload-input" accept="image/*">
  </div>

  <div id="messages"></div>

  <div id="input-area">
    <input type="text" id="message-input" placeholder="Ketik pesan...">
    <button id="send-btn">ðŸ“© Kirim</button>
  </div>
</div>

<!-- ðŸ”Š Template audio -->
<audio id="send-sound" src="sound click/zapsplat_multimedia_button_click_004_68776.mp3" preload="auto"></audio>
<audio id="click-sound" src="sound click/zapsplat_multimedia_plastic_button_press_light_fast_113387.mp3" preload="auto"></audio>

<script>
  const chatIcon = document.getElementById("chat-icon");
  const chatBox = document.getElementById("chat-box");
  const sendBtn = document.getElementById("send-btn");
  const messageInput = document.getElementById("message-input");
  const usernameInput = document.getElementById("username-input");
  const messagesDiv = document.getElementById("messages");
  const sendSound = document.getElementById("send-sound");
  const clickSound = document.getElementById("click-sound");
  const profilePic = document.getElementById("profile-pic");
  const uploadInput = document.getElementById("upload-input");

  let profileImageSrc = profilePic.src;

  chatIcon.addEventListener("click", () => {
    chatBox.classList.toggle("active");
    clickSound.play();
  });

  uploadInput.addEventListener("change", (e) => {
    const file = e.target.files[0];
    if (file) {
      const reader = new FileReader();
      reader.onload = function(evt) {
        profileImageSrc = evt.target.result;
        profilePic.src = profileImageSrc;
      };
      reader.readAsDataURL(file);
    }
  });

  messageInput.addEventListener("input", () => {
    const user = usernameInput.value.trim() || "User";
    showTypingIndicator(`${user} sedang mengetik...`);
  });

  function showTypingIndicator(text) {
    removeTypingIndicator();
    const typing = document.createElement("div");
    typing.className = "typing-indicator";
    typing.id = "typing";
    typing.textContent = text;
    messagesDiv.appendChild(typing);
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
  }

  function removeTypingIndicator() {
    const typing = document.getElementById("typing");
    if (typing) typing.remove();
  }

 function sendMessage() {
  const text = messageInput.value.trim();
  const user = usernameInput.value.trim();
  if (text && user) {
    const div = document.createElement("div");
    div.className = "message";

    const img = document.createElement("img");
    img.src = profileImageSrc;
    img.alt = "Profil";
    img.style.width = "32px";
    img.style.height = "32px";
    img.style.borderRadius = "50%";
    img.style.objectFit = "cover";
    img.style.border = "1px solid #7f00ff";

    const span = document.createElement("span");
    span.className = "message-text";
    span.textContent = `${user}: ${text}`;

    div.appendChild(img);
    div.appendChild(span);
    messagesDiv.appendChild(div);
    messageInput.value = "";
    removeTypingIndicator();
    messagesDiv.scrollTop = messagesDiv.scrollHeight;
    sendSound.play();
  }
}

  sendBtn.addEventListener("click", sendMessage);

  messageInput.addEventListener("keydown", (e) => {
    if (e.key === "Enter") {
      sendMessage();
    }
  });
</script>

</body>
</html>
